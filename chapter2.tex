\chapter{ОПТИМАЛЬНОЕ ЦЕНТРАЛИЗОВАННОЕ УПРАВЛЕНИЕ В ЭКОНОМИЧЕСКОЙ ЗАДАЧЕ}\label{chap2}
В данной главе описывается сведение задачи оптимального управления к задаче линейного программирования. Формулируется и решается линейная задача оптимального управления в непрерывном времени. Рассматривается алгоритм централизованного управления.

\section{Задача оптимального управления для модели расширяющейся экономики фон Неймана}\label{1sec:Neyman}
%\section{Построение программных решений}\label{1sec:program-solution}
Простой и наглядной задачей, с помощью которой можно
проиллюстрировать предлагаемый подход децентрализованного управления, является задача оптимального управления для модели расширяющейся экономики фон Неймана.
Данная модель ещё в 30-е годы была сформулирована Джоном фон Нейманом, который решил для ней задачу оптимизации многошаговых процессов в своеобразном классе допустимых управлений.

Рассмотрим замкнутую экономику, которая на промежутке времени $T = [0, z]$ производит $n$ типов товаров с использованием $r$ технологических процессов (ТП).

Технологический процесс $j$ при единичной интенсивности расходует товар $i$ в количестве ${a_i}_j$ и производит в количестве ${b_i}_j$, $i\in I ={1, ..., n}, j\in J ={1, ..., r}$.

Если за $x_i(t)$ принять количество $i$ -го товара, $u_j(t)$ — интенсивность $j$ -го ТП в момент $t$, $x(t) = (x_i(t), i\in I)$ — вектор товаров, $u(t) = (u_i(t), j \in J)$ — вектор интенсивностей ТП в момент t, $A = ({a_i}_j, i \in I, j \in J)\in \mathbb{R}^{n\times n}$,
$B = ({b_i}_j,i \in I, j \in J )\in \mathbb{R}^{n\times r}$ — матрицы затрат и выпуска, соответственно, $x_0$— $n$ - вектор начальных объёмов товаров, то непрерывная модель расширяющейся экономики описывается линейным дифференциальным уравнением
\begin{equation} \label{2.1}
\dot{x}= (B - A)u(t),\quad x(0) = x_0, \quad t\geq 0
\end{equation}
На переменные модели (\ref{2.1}) накладываются ограничения:
\begin{equation} \label{2.2}
Au(t)\leq x(t), u(t)\geq 0, t \geq 0,
\end{equation}
Ограничения (\ref{2.2}) связаны с невозможностью расходовать больше товара, чем имеется в наличии в каждый момент времени, а также необходимостью использовать неотрицательную интенсивность ТП.

Будем искать такой план производства, при котором в заданный момент $T$ стоимость товаров будет максимальной.
\begin{equation} \label{2.3}
c'x(T) = \sum_{i\in I}^{}c'(t)u(t)
\end{equation}
Здесь $c = (c_i, i\in I)$ – вектор цен.

Таким образом, задача оптимального управления системой (\ref{2.1}) имеет вид
\begin{equation} \label{2.4}
    J(u) = c'x(T)\to \max,
\end{equation}
$$
    \dot{x}=(B - A)u,\quad x(0) = x_0,
    $$
$$
    Au(t)\leq x(t),
    $$
$$
    u(t)\geq 0, \quad  t\in [0, T].
    $$

\section{Обсуждение особенностоей задачи}\label{1sec:discussion}
При практическом применении результатов теории управления необходимо учитывать следующие особенности:

1. Все реальные экономические объекты управления содержат неопределенности: возмущения, неточности математического моделирования, ошибки измерений и др. Например, модель (\ref{2.1}) может быть подвержена действию возмущений,
вызванных сбоями в работе ТП, их работой не на полную мощность, браком товаров.

2. При управлении в условиях неопределенности используются обратные связи. Их построение в явном виде для задач с ограничениями (как в (\ref{2.4})) в большинстве случаев невозможно, а применение результатов динамического программирования сдерживается "проклятием размерности" \cite{Bellman}.

3. Сложные системы управления часто имеют структуру, учет которой позволяет упростить или ускорить процедуры построения обратных связей. Важным примером системы со структурой являются так называемые мультиагентные системы \cite{Dmitruk14b}, для которых характерно применение децентрализованного управления: каждый "агент"\ управляется локально, но преследуется общая цель при общих ограничениях на состояния и управления.

В задаче (\ref{2.4}) также можно выделить структуру: она задается технологическими процессами. Соответственно, управление здесь можно организовать двумя способами:

1) Централизованно, когда один управляющий орган (регулятор) принимает решение для всех ТП одновременно.

2) Децентрализованно, когда для каждого ТП интенсивность выбирается относительно независимо, локальным управляющим органом (локальным регулятором).

Цель при децентрализованном управлении общая – максимизация гарантированной стоимости товаров, произведенных всеми процессами к моменту времени T , но все решения необходимо принимать локально, не нарушая при этом общих ограничений.

Далее в настоящей главе будет рассматриваться централизованное управление. Начнём с построения программного решения задачи, которая обобщает (\ref{2.4}).

\section{Построение программных решений}\label{1sec:programm-solution}

Cформулируем задачу оптимального управления линейной динамической системы, на состояния и управления которой наложены смешанные ограничения:

\begin{equation} \label{2.5}
    J(u) = c'x(T)\to \max,
\end{equation}
$$
    \dot{x}=Ax(t) + Bu(t),\quad x(0) = x_0,
    $$
$$
    Hx(t) + Gu(t)\leq g,
    $$
$$ u(t)\in U, \quad  t\in [0, T].
    $$
Здесь $x(t) \in \mathbb{R}^n$ — состояние, $u(t) \in R^r$ — управление, $A \in \mathbb{R}^{n\times n}, B \in \mathbb{R}^{n\times r}, H \in \mathbb{R}^{n\times p}, G\in \mathbb{R}^{m\times r},$ — заданные матрицы; $U \subset \mathbb{R}^r$.

Задача (\ref{2.5}) обобщает задачу (\ref{2.4}) для которой:
$$A = 0, B = B - A, H = -E, G = A, g = 0$$.

Будем считать, что для целей управления доступны полные и точные измерения состояний, которые поступают в дискретные моменты времени $\tau \in \Delta = {0, h, ..., T - h},$ где $h = T/N$ — период квантования. Траекторию измерений в конкретном процессе управления будем обозначать $x^*(\tau), \tau \in \Delta;$ она зависит от $u^*(\cdot)$ выбранного управления.


Для решения задачи (\ref{2.5}) сведём ее к задаче линейного программирования с помощью формулы Коши для линейной системы.

\begin{equation} \label{2.6}
x(t) = F(t,0)x_0 + \int_{0}^{t} F(T,\theta)B(\theta)u(\theta) dt ,
\end{equation}
где $F(T,t)$ --- фундаментальная матрица, т.е. решение уравнения
$$
    \dot F(T,t) = - F(T,t)A(t),\quad F(T,T) = E.
    $$
Интеграл в правой часть равенства (\ref{2.6}) запишем следующим образом:
\begin{equation} \label{2.7}
x(t) = F(t,0)x_0 +  \sum_{s\in T_h}^{t-h}\int_{s}^{s+h} F(t,\theta)B(\theta)\,d\theta \  u(s).
\end{equation}
где $T_h(t) = \{0, h, ..., t-h\}$

Используя (\ref{2.7}) запишем левую часть терминального ограничения:

\begin{equation} \label{2.8}
Hx(t) + Gu(t) = HF(t,0)x_0 + \sum_{s \in T_h}^{t-h}\int_{s}^{s+h} HF(t,\theta)B(\theta)\,d\theta \ u(s) + Gu(t).
\end{equation}

Равенство  (\ref{2.8}) перепишем в следующем виде:
$$
    Hx(t) + Gu(t)= \Phi(t)x_0 +  \sum_{s \in T_h}^{t-h}D(s)u(s) + Gu(t)
    $$
где введены следующие обозначения:
$$
    \Phi(t) = HF(T,t) \quad \Phi(T) = H, \quad \dot{\Phi} = -\Phi A(t);
    $$
$$
    D(s) =\int_{s}^{s+h} \Phi(t)B(t)\,dt,\quad s\in [0, T - h].
    $$

Таким образом, исходная задача (\ref{2.5}) эквивалентна следующей задаче линейного программирования:
\begin{equation} \label{2.9}
\sum_{t = 0}^{T - h}c'(t)u(t) \to \min,
\end{equation}
$$ \sum_{s \in T_h}^{t-h}D(s)u(s) + Gu(t) \leq g^*,$$
$$
    u_*\leq u(t) \leq u^*,\quad t \in [0, T - h],
$$
где
$$
    c'(t) = \int_{s}^{s+h} F(t,0)B(t)\,dt,\quad s\in [0, T - h],
    $$
$$
    g^*(t) = g - \Phi(t)x_0.
    $$

Таким образом,для решения задачи ЛП получим следующие данные:
\begin{equation*}
  A_lp = \left(
\begin{array}{ccccc}
  G & 0 & 0 & \ldots & 0 \\
  D(0) & G & 0 & \ldots & 0 \\
  D(0) & D(h) & G & \ldots & 0 \\
  \vdots & \vdots & \vdots & \ddots & \vdots \\
  D(0) & D(h) & \ldots & D(T - h) & G
\end{array}
\right)
\end{equation*}

\begin{equation*}
  u_lp = \left(
\begin{array}{c}
  u(0) \\
  u(h) \\
  u(2h) \\
  \vdots \\
  u(T-h)
\end{array}
\right)
\end{equation*}

\begin{equation*}
  b_lp = \left(
\begin{array}{c}
  g - \Phi(0)x_0 \\
  g - \Phi(h)x_0 \\
  g - \Phi(2h)x_0 \\
  \vdots \\
  g - \Phi(T - h)x_0 
\end{array}
\right)
\end{equation*}

\section{}\label{1sec:discussion}
При сделанном предположении определим понятие (дискретной) оптимальной обратной связи в задаче (\ref{2.4}).
Для этого погрузим ее в семейство задач оптимального управления

\begin{equation} \label{2.10}
    J(u) = c'x(T)\to \max,
\end{equation}
$$
    \dot{x}=Ax(t) + Bu(t),\quad x(\tau) = z,
    $$
$$
    Hx(t) + Gu(t)\leq g,
    $$
$$
     u(t)\in U, \quad  t\in [\tau, T]
    $$
зависящее от пары $(\tau, z), \tau \in \Delta, z \in R^n$, которая называется позицией процесса управления.

Пусть $u^0(t| \tau, z) , t \in [\tau, T]$, – оптимальная гарантирующая программа управления в задаче (\ref{2.10}) для позиции $(\tau, z), X(\tau)$ — множество всех состояний $z$, для которых в заданный момент $\tau$ оптимальная гарантирующая программа существует.

В связи с трудностями построения обратных связей, современные подходы, применяемые в теории управления, направлены на построение обратной связи в каждом конкретном процессе управления по решению вспомогательных (прогнозирующих) задач оптимального управления. Эти задачи формулируются для каждого текущего момента таким образом, чтобы обеспечить желаемое поведение замкнутой системы. Для задач оптимального управления с конечным горизонтом управления (как в задаче (\ref{2.5})) подход
носит название управления в реальном времени.

Проводя аналогичные рассуждения,как и в (\ref{1sec:programm-solution}), для (\ref{2.10}) получим следующую задачу ЛП:

\begin{equation} \label{2.11}
\sum_{t = \tau}^{T - h}c'(t)u(t) \to \min,
\end{equation}
$$
 \sum_{s = \tau}^{t-h}D(s)u(s) + Gu(t) \leq g^*,
    $$
$$
    u_*\leq u(t) \leq u^*,\quad t \in [\tau, T],
    $$
где
$$
    c'(t) = \int_{s}^{s+h} F(t,0)B(t)\,dt,\quad s\in [\tau, T - h],
    $$
$$
    g^* = g - \Phi(\tau)z,
    $$